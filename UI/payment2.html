<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title><?lsmb titlebar ?></title>
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="-1" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="css/<?lsmb stylesheet ?>" type="text/css" />

  <meta http-equiv="content-type" content="text/html; charset=<?lsmb charset ?>" />  
  <meta name="robots" content="noindex,nofollow" />
</head>
<body id="payment_2_body">
 <form name="pay_single_dues" method="post" action="payment.pl">

 <?lsmb PROCESS elements.html  # Include form elements helper. ?>

 <table width=100%>
  <tr id="top_bar" class="listtop">
    <th id="top_bar_header" class="listtop"><?lsmb header.text ?></th>
  </tr>
 </table>
 <table width=100% id="info_table">
  <tr valign=top id="info_row">
   <td width=50% id="info_data">
    <table id="cv_info_table">
     <tr id="cv_row">
      <th class="label_left" id="cv_label_column"><?lsmb  text('Vendor') ?></th>
       <td id="cv_column"><?lsmb vc.name ?></td>
     </tr>
     <tr id="cv_address_row">
      <th valign="top" align="right" id="cv_address_label_column"><?lsmb text('Address') ?></th>
      <td id="cv_address_column">
       <table id="cv_address_table">
       <?lsmb # this table will show the customer/vendor address, city, phone and others things that could help to reminds them?>
       <?lsmb FOREACH address IN vc.address  # Loop through customer/vendor address info ?>
         <tr>
          <td><?lsmb address.text ?></td>
         </tr>
	      <?lsmb END ?>
        </table>
      </td>
     </tr>
     <tr align="right" id="notes_row">
      <th valign="top" id="notes_column"><?lsmb text('Notes') ?></th>
      <td><textarea id="notes" name="notes" cols="35" rows="3"></textarea></td>
     </tr>
    </table>
   </td>
   <td align="right">
    <table>
     <?lsmb # the project will be shown if it was selected in the first step  ?>
     <?lsmb IF project.value  # Only process element if the value exists.  ?>
     <tr id="project_row">
      <th align="right" nowrap id="project_label_column"><?lsmb text('Projects') ?>:</th>
      <td colspan="2" id="project_column">
          <?lsmb project.text ?>
	  <?lsmb  project.type="hidden"; PROCESS input element_data=project ?>
     </td>
     </tr>
     <?lsmb END ?>
     <?lsmb #the department will be shown if it was selected in the first step ?>
     <?lsmb IF department.value  # Only process element if one exists. As in project above ?>
     <tr id="department-row">
      <th align="right" nowrap id="department_label_column"><?lsmb  text('Department')  ?>:</th>
      <td colspan="2" id="department_column">
       <?lsmb  department.text ?>
       <?lsmb  department.type="hidden"; PROCESS input element_data=department ?>
      </td>
     </tr>
     <?lsmb END ?>
     <tr id="account_row">
     <?lsmb  #here goes all the posible accounts were the paid can be done  ?>
      <th align="right" nowrap id="account_label_column"><?lsmb text('Account') ?></th>
      <td colspan="2" id="account_column"><?lsmb PROCESS select element_data=account ?></td>
     </tr>
     <tr id="date_row"><?lsmb # here goes an input where the date can be written, we can also use a java calendar :). We can use an ajax script to call the Exchange rate of the input date wich can be called with the onChange Method	  ?>
      <th align="right" nowrap id="date_label_column"><?lsmb text('Date') ?></th>
      <td colspan="2" id="date_column"> <?lsmb PROCESS input element_data=datepaid ?> </td>
     </tr>
     <tr id="source_row">
     <?lsmb # here goes all the posible sources wich we can use ?>
      <th align="right" nowrap id="source_label_column"><?lsmb text('Source')?></th>
       <td width="28%" id="source_column"><?lsmb PROCESS select element_data=source ?></td>
       <td id="source_text_column"><?lsmb PROCESS input element_data=source_text ?></td>
     </tr>
     <tr id="currency_row">
     <?lsmb #  here goes the selected currency in step 1 ?>
      <th align="right" id="currency_label_column"><?lsmb text('Currency') ?>:</th>
      <td id="currency_column"><?lsmb PROCESS label element_data=curr ?></td>
     </tr>
     <?lsmb # here goes the exchange rate of the selected currency, it can be done by the ajax script or the update button ?>
     <?lsmb  IF defaultcurrency.text != curr.text # Only process element if one exists. ?>
      <tr id="exrate_row">
       <th valig="top" align="right" id="exrate_label_column"><?lsmb text('Exchange Rate') ?>:</th>
       <td id="exrate_column">
        <?lsmb  IF date_curr.value ?>
         <?lsmb  date_curr.text ?>
        <?lsmb  END ?>
        <?lsmb  IF !date_curr.value ?>
         <?lsmb PROCESS input element_data=date_curr ?>
        <?lsmb  END ?>
       </td>
      </tr>
     <?lsmb END ?>
    </table>
   </td>
  </tr>
 </table>
 <table width="100%" border="1">
  <tr class="listheading">
   <?lsmb FOREACH column IN column_headers  # Loop through columns ?>
   <th class="listheading"><?lsmb column.text ?></th>
   <?lsmb END ?>
  </tr>
  <?lsmb # We have to clear i for later usage :)  ?>
  <?lsmb i = '0' ?>
  <?lsmb FOREACH row IN rows ?>
  <?lsmb i = i + 1; j = i % 2; alterning_style = "listrow$j" ?>
  <tr class="<?lsmb alterning_style ?>"=>
    <td><a href="<?lsmb row.invoice.href ?>"><?lsmb row.invoice.number ?></a>
        <input type="hidden" value="<?lsmb row.invoice.id ?>" />                 </td>
    <?lsmb # we can use an href to link this invoice number to the invoice ?>
    <td><?lsmb row.invoice_date ?></td>
    <td><?lsmb row.amount ?></td>
    <td><?lsmb row.paid ?></td>
    <td><?lsmb row.due ?></td>
    <?lsmb IF defaultcurrency.text != curr.text ?>
    <td><?lsmb row.exchange_rate ?></td>
    <td><?lsmb row.due_fx ?></td>
    <td><div id="<?lsmb "div_topay_invoice_$i" ?>"><?lsmb row.topay ?></div></td>
    <?lsmb END ?> 
    <?lsmb #This should be computed and updated to the div using  ?> 
    <td><?lsmb PROCESS input  element_data=row.topay_fx ?><div id="<?lsmb "div_topay_$i" ?>">
    <hr />  
    <table>
     <tr id="<?lsmb "account-row$i"?>">
      <?lsmb # here goes all the posible accounts were the paid can be  done ?>
      <th align="right" nowrap id="<?lsmb "account_label_column$i" ?>"><?lsmb text('Account') ?></th>
      <td colspan="2" id="<?lsmb "account_column$i" ?>"><?lsmb PROCESS select element_data=account ?></td>
     </tr>
     <tr id="<?lsmb "source_row$i" ?>">
      <?lsmb # here goes all the posible sources wich we can used ?>
      <th align="right" nowrap id="<?lsmb "source_label_column$i" ?>"><?lsmb text('Source') ?></th>
      <td width="28%" id="<?lsmb "source_column$i" ?>"><?lsmb PROCESS select element_data=source ?></td>
      <td><?lsmb PROCESS input element_data=source_text ?></td>   
      <td nowrap align="left"><input  name="<?lsmb "optionalpay_$i" ?>" type="checkbox"  class="checkbox"></td>
     </tr>
    </table>
   </div>
   <?lsmb END ?>
  </table>
  <hr />
  <?lsmb PROCESS button element_data=post ?>
  <?lsmb PROCESS button element_data=post_and_print ?>
  <?lsmb PROCESS select element_data=format ?>
  <?lsmb PROCESS select element_data=media ?>
  </form>
 </body>
</html>
